{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<meta name="referrer" content="always">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no,address=no,email=no">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
	<!-- No cache -->
	<meta http-equiv="Expires" content="-1">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache; no-store; no-save">
	<!-- Summary -->
	<meta name="Keywords" content="자동차, 자동차뉴스, 시승기, 중고차뉴스, 신차뉴스, 자동차업계, 자동차업계뉴스">
	<meta name="Description" content="카뉴스집은 9개 자동차 언론사들의 뉴스를 모아 제공합니다. (신차, 중고차, 시승기, 자동차업계)">
	<meta http-equiv="Author" content="카뉴스집">
	<meta http-equiv="Other Agent" content="카뉴스집">
	<meta http-equiv="Reply-To" content="naver@naver.com">
	<meta http-equiv="Email" content="naver@naver.com">
	<meta http-equiv="Build" content="2020.12" />
	<meta property="og:title" content="카뉴스집">
	<meta property="og:description" content="카뉴스집, 자동차 뉴스, 중고차 뉴스, 신차 뉴스, 자동차 시승기">
	<title>카뉴스집 🙈 | CAR_NEWS_ZIP</title>
	<link rel="shortcut icon" href="{% static 'favico.png' %}">
	<!-- CSS -->
	<link rel="stylesheet" href="{% static 'css/reset.css' %}">
	<link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">
	<link rel="stylesheet" href="{% static 'css/swiper.css' %}">
	<link rel="stylesheet" href="{% static 'css/content.css' %}">
    <!--[if lt IE 9]>
		<script src="../resources/js/html5shiv.min.js"></script>
	<![endif]-->
</head>
<body>
<div id="wrap">
	<header class="header">
		<h1 class="service-name">
			카뉴스집 🙈<br>
			<span><a href="{% url 'reload_data' %}" title="숨은기능 : 데이터 새로 받아오기 (약 1분 소요)" class="btn-reload-data">[{{ today_date }} 
				{% if user %}
					{{ user }} 님만을 위한 뉴스!
				{% else %}
					CAR NEWS ZIP
				{% endif %}
			]</a></span>
		</h1>
		<div class="fncs">
			{% if user %}
				<a href="/logout/" class="btn-login">로그아웃</a>
			{% else %}
				<a href="/login/" class="btn-logout">로그인</a>
			{% endif %}
			<select name="" id="" class="view-mode-changer">
				<option value="dark">Dark mode</option>
				<option value="light" selected>Light mode</option>
			</select>
		</div>
	</header>
	<section class="container">
		<div class="category-list">
			<div class="inner">
				<ul>
					<li class="curr"><a href="javascript:;">중고차 뉴스</a></li>
					<li><a href="javascript:;">신차 뉴스</a></li>
					<li><a href="javascript:;">시승기</a></li>
					<li><a href="javascript:;">자동차 업계 뉴스</a></li>
				</ul>
			</div>
		</div>
		<div class="item-list">
			<div class="inner">
				<p class="txt-guide">* 뉴스 기사를 클릭하면 해당 뉴스로 이동됩니다.</p>
				<ul class="news-group show">
					{% for list in total_car_news_list %}
						<li>
							<a href="{{ list.news_url }}" target="_blank" title="{{ list.news_title }}">
								{% if list.media_code == '200' or list.news_img_url == 'None' or list.news_img_url == '' %}
								<div class="picture">
									<p><span class="ico">😰</span><br>해당 언론사에서<br>이미지를 불러올 수 없습니다.</p>
								</div>
								{% else %}
								<div class="picture" style="background:url('{{ list.news_img_url }}') no-repeat center; background-size:cover;"></div>
								{% endif %}
								<div class="info-box">
									<div class="tags">
										{% if list.write_date == today_date %}
											<span class="today">TODAY</span>
										{% endif %}
										{% if list.media_code == '100' %}
											<span class="ah">{{ list.media_name }}</span>
										{% elif list.media_code == '200' %}
											<span class="daily">{{ list.media_name }}</span>
										{% elif list.media_code == '300' %}
											<span class="auto-view">{{ list.media_name }}</span>
										{% elif list.media_code == '400' %}
											<span class="chosun">{{ list.media_name }}</span>
										{% elif list.media_code == '500' %}
											<span class="auto-morning">{{ list.media_name }}</span>
										{% elif list.media_code == '600' %}
											<span class="auto-diary">{{ list.media_name }}</span>
										{% elif list.media_code == '700' %}
											<span class="carguy">{{ list.media_name }}</span>
										{% elif list.media_code == '800' %}
											<span class="drive">{{ list.media_name }}</span>
										{% endif %}
									</div>
									<p class="subject">{{ list.news_title }}</p>
									<p class="summary">{{ list.news_content }}</p>
								</div>
							</a>
							<div class="infos">
								<span class="date">{{ list.write_date }}</span>
								<button type="button" class="btn-like">👍 <strong>0</strong></button>
							</div>
						</li>
					{% endfor %}
				</ul>
			</div>
		</div>
	</section>
	<div class="loading">
		<div class="dim"></div>
		<div class="loading-box">
			<div class="out-box">
				<i class="in-box"></i>
			</div>
			<p>
				데이터를 불러오는 중입니다.<br>
				(잠시만 기다려주세요.)
			</p>
		</div>
	</div>
</div>

<!-- Javascript -->
<script type="text/javascript" src="/static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="/static/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="/static/js/swiper.min.js"></script>
<script type="text/javascript" src="/static/js/common.js"></script>
<script data-ad-client="ca-pub-3984460457062336" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-T4CL1V9FXP"></script>
<script>
	$(function(){
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'G-T4CL1V9FXP');

		// loadNewsList(0);

		{% comment %} $('.category-list ul li a').on('click', function(){
			var idx = $(this).parent('li').index();
			$('.category-list ul li').removeClass('curr').eq(idx).addClass('curr');
			$('.news-group').removeClass('show');
			$('.news-group').eq(idx).addClass('show');
		}); {% endcomment %}

		$('.category-list ul li a').on('click', function(){
			var idx = $(this).parent('li').index();
			$('.category-list ul li').removeClass('curr').eq(idx).addClass('curr');
			loadNewsList(idx);
		});

		$('.btn-reload-data').on('click', function(){
			$('.loading').show();
		});

		$('.view-mode-changer').on('change', function(){
			var skinMode = $(this).val();
			if(skinMode == 'dark'){
				$('#wrap').addClass('darkmode');
			}else{
				$('#wrap').removeClass('darkmode');
			}
		});
	});

	function loadNewsList(idx){
		$('.loading').show();
		$.ajax({
			url: '{% url "list_data" %}',
			type: 'GET',
			data: {
				'idx': idx
			},
			dataType: 'json',
			success: function(data){
				console.log(data)
				$('.loading').hide();
				var newsList = "";
				newsList += '{% for list in total_car_news_list %}';
				newsList += '<li>';
				newsList += '<a href="{{ list.news_url }}" target="_blank" title="{{ list.news_title }}">';
				newsList += '{% if list.media_code == "200" or list.news_img_url == "None" or list.news_img_url == "" %}';
				newsList += '<div class="picture">';
				newsList += '<p><span class="ico">😰</span><br>해당 언론사에서<br>이미지를 불러올 수 없습니다.</p>';
				newsList += '</div>';
				newsList += '{% else %}';
				newsList += '<div class="picture" style="background:url(\'{{ list.news_img_url }}\') no-repeat center; background-size:cover;"></div>';
				newsList += '{% endif %}';
				newsList += '</a>';
				newsList += '</li>';
				newsList += '{% endfor %}';

				$('.news-group').html(newsList)
			},
			error : function(request, status, error){
				console.log(error)
			},
		});
	}
</script>
</body>
</html>